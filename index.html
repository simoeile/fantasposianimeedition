<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <title>Fanta Sposi - Anime Edition</title>
  <style>
    /* Stili rimangono uguali */
    body { font-family: 'Comic Sans MS', cursive; margin: 0; background-color: white; text-align: center; }
    header { background-image: url('Logo SI - senza sfondo.png'); background-size: contain; background-repeat: no-repeat; background-position: center; padding: 40px 10px; }
    h1 { text-transform: uppercase; font-size: 3em; color: black; text-shadow: -1px -1px 0 #fff, 1px -1px 0 #fff, -1px 1px 0 #fff, 1px 1px 0 #fff; margin: 0; padding: 20px 10px; }
    nav { display: flex; justify-content: center; gap: 20px; background-color: #008080; padding: 10px; }
    nav a { color: white; text-decoration: none; font-weight: bold; font-size: 1.1em; }
    .container { padding: 20px; }
    section h2 { text-transform: uppercase; font-size: 1.8em; }
    .team { width: 90%; max-width: 600px; height: 200px; margin: 30px auto; background-size: contain; background-position: center; background-repeat: no-repeat; border-radius: 15px; box-shadow: 0 4px 10px rgba(0,0,0,0.3); cursor: pointer; transition: transform 0.3s ease; }
    .team:hover { transform: scale(1.05); }
    table { width: 80%; margin: 0 auto; border-collapse: collapse; margin-top: 20px; }
    th, td { border: 1px solid #008080; padding: 10px; text-align: center; }
    th { background-color: #008080; color: white; }
    footer { background-image: url('Logo SI - senza sfondo.png'); background-size: contain; background-repeat: no-repeat; background-position: center; height: 150px; margin-top: 40px; }
  </style>
</head>
<body>

  <header>
    <h1>Fanta Sposi - Anime Edition</h1>
  </header>

  <nav>
    <a href="#istruzioni">Istruzioni</a>
    <a href="#squadre">Squadre</a>
    <a href="#classifica">Classifica</a>
  </nav>

  <div class="container">
    <section id="istruzioni">
      <h2>COME SI GIOCA?</h2>
      <p>Benvenuti al Fanta Sposi in stile anime! Ogni tavolo/squadra ha tempo fino al taglio della torta per completare quante più sfide possibili. Ogni sfida completata farà guadagnare punti al proprio tavolo. La squadra che realizzerà il punteggio più alto vincerà la partita e la gloria eterna (magari anche un piccolo forziere!).</p>
    </section>

    <section id="squadre">
      <div class="team" style="background-image: url('Logo One Piece - senza sfondo.png')" onclick="openTeam('onepiece.html')"></div>
      <div class="team" style="background-image: url('Logo Arale - senza sfondo.png')" onclick="openTeam('arale.html')"></div>
      <div class="team" style="background-image: url('Logo Naruto Shippuden - senza sfondo.png')" onclick="openTeam('naruto.html')"></div>
      <div class="team" style="background-image: url('Logo Dragon Ball Z - senza sfondo.png')" onclick="openTeam('dragonballz.html')"></div>
      <div class="team" style="background-image: url('Logo Detective Conan - senza sfondo.png')" onclick="openTeam('conan.html')"></div>
      <div class="team" style="background-image: url('Logo Holly e Benji - senza sfondo.png')" onclick="openTeam('hollyebenji.html')"></div>
      <div class="team" style="background-image: url('Logo Ken il guerriero - senza sfondo.png')" onclick="openTeam('ken.html')"></div>
      <div class="team" style="background-image: url('Logo Yu yu hakusho - senza sfondo.png')" onclick="openTeam('yuyuhakusho.html')"></div>
    </section>

    <section id="classifica">
      <h2>Classifica</h2>
      <table id="scoreTable" style="margin: auto; border-collapse: collapse;">
        <thead>
          <tr>
            <th style="padding: 10px; border: 1px solid #ccc;">Squadra</th>
            <th style="padding: 10px; border: 1px solid #ccc;">Punteggio</th>
          </tr>
        </thead>
        <tbody id="scoreBody">
          <!-- Riempito da JavaScript -->
        </tbody>
      </table>
    </section>
  </div>

  <footer></footer>

  <script>
    const baseUrl = 'https://storage.fantasposianimeedition.it/apps/files/files';

    const teams = [
      { name: 'One Piece', key: 'onepieceMedia' },
      { name: 'Arale', key: 'araleMedia' },
      { name: 'Naruto', key: 'narutoMedia' },
      { name: 'Dragon Ball Z', key: 'dragonballzMedia' },
      { name: 'Detective Conan', key: 'conanMedia' },
      { name: 'Holly e Benji', key: 'hollybenjiMedia' },
      { name: 'Ken il Guerriero', key: 'kenMedia' },
      { name: 'Yu Yu Hakusho', key: 'yuyuhakushoMedia' },
    ];

    async function caricaDatiSquadra(teamKey) {
      try {
        const response = await fetch(`${baseUrl}/${teamKey}.json`);
        if (!response.ok) throw new Error('Dati non trovati');
        const dati = await response.json();
        return dati;
      } catch (e) {
        console.warn(`Impossibile caricare dati per ${teamKey}, uso array vuoto.`);
        return [];
      }
    }

    async function aggiornaClassifica() {
      const tbody = document.getElementById("scoreBody");
      tbody.innerHTML = "";

      for (const team of teams) {
        const data = await caricaDatiSquadra(team.key);
        const totale = data.reduce((acc, cur) => acc + (parseInt(cur.punteggio) || 0), 0);

        const row = document.createElement("tr");
        row.innerHTML = `
          <td style="padding: 10px; border: 1px solid #ccc;">${team.name}</td>
          <td style="padding: 10px; border: 1px solid #ccc;">${totale}</td>
        `;
        tbody.appendChild(row);
      }
    }

    function openTeam(page) {
      window.location.href = page;
    }

    aggiornaClassifica();
  </script>
</body>
</html>
